from dbpredict_pipes import get_data
import pytest

##tests for ccs_icd9##
@pytest.fixture()
def ccs_icd9():
    output = ['7955', '79551','79552','7956',
 '79579', 'V010', 'V011', 'V012', 'V013', 'V014', 'V015', 'V016', 'V017',
 'V0171', 'V0179', 'V018', 'V0181', 'V0182', 'V0183', 'V0184', 'V0189', 'V019',
 'V020', 'V021', 'V022', 'V023', 'V024', 'V025', 'V0251', 'V0252', 'V0253',
 'V0254', 'V0259', 'V026', 'V0260', 'V0261', 'V0262', 'V0269', 'V027', 'V028',
 'V029', 'V030', 'V031', 'V032', 'V033', 'V034', 'V035', 'V036', 'V037',
 'V038', 'V0381', 'V0382', 'V0389', 'V039', 'V040', 'V041', 'V042', 'V043',
 'V044', 'V045', 'V046', 'V047', 'V048', 'V0481', 'V0482', 'V0489', 'V050',
 'V051', 'V052', 'V053', 'V054', 'V058', 'V059', 'V060', 'V061', 'V062',
 'V063', 'V064', 'V065', 'V066', 'V068', 'V069', 'V286', 'V712', 'V7182',
 'V7183', 'V730', 'V731', 'V732', 'V733', 'V734', 'V735', 'V736', 'V738',
 'V7381', 'V7388', 'V7389', 'V739', 'V7398', 'V7399', 'V740', 'V741', 'V742',
 'V743', 'V744', 'V745', 'V746', 'V748', 'V749', 'V750', 'V751', 'V752',
 'V753', 'V754', 'V755', 'V756', 'V757', 'V758', 'V759', '5997', '59970',
 '59971', '59972', '7882', '78820', '78821', '78829', '5996', '59960', '59969',
 '5998', '59989', '5999', '7881', '7883', '78830', '78831', '78832', '78833',
 '78834', '78835', '78836', '78837', '78838', '78839', '7884', '78841',
 '78842', '78843', '7885', '7886', '78861', '78862', '78863', '78864', '78865',
 '78869', '7887', '7888', '7889', '78891', '78899', '7910', '7911', '7912',
 '7913', '7914', '7917', '7919', '7935', '7944', 'V130', 'V1300', 'V1302',
 'V1303', 'V1309', 'V417', 'V435', 'V445', 'V4450', 'V4451', 'V4452', 'V4459',
 'V446', 'V474', 'V475', 'V536', 'V555', 'V556']
    return output


##tests for ccs_icd10##
@pytest.fixture()
def icd_clean(ccs_icd9):
    output = ['F529', 'N369', 'N3941', 'N3942', 'N3943', 'N3944', 'N3945',
 'N3946', 'N39490', 'N39498', 'N398', 'N399', 'R300', 'R301', 'R309', 'R310',
 'R311', 'R312', 'R319', 'R32', 'R330', 'R338', 'R339', 'R34', 'R350', 'R351',
 'R358', 'R360', 'R369', 'R390', 'R3911', 'R3912', 'R3913', 'R3914', 'R3915',
 'R3916', 'R3919', 'R392', 'R3981', 'R3989', 'R399', 'R760', 'R7611', 'R7612',
 'R768', 'R769', 'R800', 'R801', 'R803', 'R808', 'R809', 'R820', 'R821',
 'R822', 'R823', 'R825', 'R826', 'R827', 'R828', 'R8290', 'R8291', 'R8299',
 'R934', 'R944', 'Z03810', 'Z03818', 'Z110', 'Z111', 'Z112', 'Z113', 'Z114',
 'Z1151', 'Z1159', 'Z116', 'Z118', 'Z119', 'Z2001', 'Z2009', 'Z201', 'Z202',
 'Z203', 'Z204', 'Z205', 'Z206', 'Z207', 'Z20810', 'Z20811', 'Z20818',
 'Z20820', 'Z20828', 'Z2089', 'Z209', 'Z220', 'Z221', 'Z222', 'Z2231',
 'Z22321', 'Z22322', 'Z22330', 'Z22338', 'Z2239', 'Z224', 'Z2250', 'Z2251',
 'Z2252', 'Z2259', 'Z226', 'Z228', 'Z229', 'Z23', 'Z435', 'Z436', 'Z466',
 'Z87440', 'Z87441', 'Z87448', 'Z9350', 'Z9351', 'Z9352', 'Z9359', 'Z936',
 'Z960']
    output_dict = {'icd9': ccs_icd9,
                   'icd10': output}
    return output_dict


@pytest.fixture()
def cpt_clean():
    output = ['0101T', '20974', '20979', '20980', '20981', '20982', '20983',
 '26341', '29700', '29701', '29702', '29703', '29704', '29705', '29706',
 '29707', '29708', '29709', '29710', '29711', '29712', '29713', '29714',
 '29715', '79440', '79441', '79442', '79443', '79444', '79445', '98940',
 '98941', '98942', '98943', '0044T', '0400T', '0401T', '0493T', '10004',
 '10005', '10006', '10007', '10008', '10009', '10010', '10011', '10012',
 '10013', '10014', '10015', '10016', '10017', '10018', '10019', '10020',
 '10021', '10022', '10035', '10036', '11100', '11101', '11102', '11103',
 '11104', '11105', '11106', '11107', '11755', '95000', '95001', '95002',
 '95003', '95004', '95005', '95006', '95007', '95008', '95009', '95010',
 '95011', '95014', '95015', '95016', '95017', '95018', '95019', '95020',
 '95021', '95022', '95023', '95024', '95025', '95026', '95027', '95028',
 '95029', '95030', '95031', '95032', '95033', '95034', '95035', '95036',
 '95037', '95038', '95039', '95040', '95041', '95042', '95043', '95044',
 '95045', '95046', '95047', '95048', '95049', '95050', '95051', '95052',
 '95053', '95054', '95055', '95056', '95057', '95058', '95059', '95060',
 '95061', '95062', '95063', '95064', '95065', '95066', '95067', '95068',
 '95069', '95070', '95071', '95072', '95073', '95074', '95075', '95076',
 '95077', '95078', '95079', '96931', '96932', '96933', '96934', '96935',
 '96936']
    out_dict = {'exclude' : False,
                'cpt_codes': output}
    return out_dict

@pytest.fixture()
def dem_clean():
    dem_clean = {'dem_columns' : ['enrolledmons', 'pcpmons', 'rxmons', 
                                      'male', 'age', 'age18', 'age40', 'age65']
                     }
    return dem_clean


@pytest.fixture()
def phys_clean():
    phys_clean = {'phys_codes': ['10', '10', '13']}
    return phys_clean

@pytest.fixture()
def rx_clean():
    rx_clean = {'class': ['214028', '214028'],
                     'ther_names': ['13', '13', '14']}
    return rx_clean

@pytest.fixture()
def lab_clean():
    lab_clean = {'loinc_codes': ['10501-5', '10834-0', '10839-9', 
                                     '13457-7', 'PiperTazobact', 
                                     'TrimethSulfa']
                     }
    return lab_clean

def test_sql_inputs_demographics(dem_clean):
    enrollee_qry = get_data.get_enrollee_query('np_dc')
    
    


